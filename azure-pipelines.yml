# External variables:
# ServiceConnection
#   Name of ServiceConnection to DevOps project

jobs:
  - job: 'Echo'

    steps:
      - script: dir foo

  - job: 'Trigger'

    dependsOn:
      - 'Echo'

    condition: succeededOrFailed()

    pool: server

    steps:
      - task: InvokeRESTAPI@1
        inputs:
          connectionType: 'connectedServiceName'
          serviceConnection: '$(ServiceConnection)'
          method: 'POST'
          headers: '{ "Content-Type":"application/json", "Authorization": "Bearer $(System.AccessToken)" }'
          body: '{ "definition": { "id": $(System.DefinitionId) } }'
          urlSuffix: 'build/builds?api-version=5.0'
